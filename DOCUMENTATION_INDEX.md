# –ò–Ω–¥–µ–∫—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ FAgent

## HAProxy API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- üìö **[HAPROXY_API.md](HAPROXY_API.md)**
  - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ HAProxy –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–µ–¥–∏–Ω–∏—á–Ω—ã–µ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã)
  - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ troubleshooting
  - –ü—Ä–∏–º–µ—Ä—ã –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ API –º–µ—Ç–æ–¥–æ–≤
- üìñ **[HAPROXY_API_REFERENCE.md](HAPROXY_API_REFERENCE.md)**
  - –ü–æ–ª–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤—Å–µ—Ö API –º–µ—Ç–æ–¥–æ–≤
  - –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  - –°—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (Rolling Update, Blue-Green, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
  - –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø–∞–∫–µ—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

- üìã **[HAPROXY_API_METHODS_TABLE.md](HAPROXY_API_METHODS_TABLE.md)**
  - –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
  - –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ endpoints
  - –¢–∞–±–ª–∏—Ü–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –¥–µ–π—Å—Ç–≤–∏–π
  - –ü–æ–ª–µ–∑–Ω—ã–µ –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω–∏–∫–∏

- üéØ **[HAPROXY_CURL_CHEATSHEET.md](HAPROXY_CURL_CHEATSHEET.md)**
  - –ì–æ—Ç–æ–≤—ã–µ curl –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
  - –ö–æ–º–∞–Ω–¥—ã —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º (jq)
  - Bash –∞–ª–∏–∞—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏
  - –û—Ç–ª–∞–¥–∫–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã
- üìù **[README.md](README.md)**
  - –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
  - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
  - –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- üéØ **[CLAUDE.md](CLAUDE.md)**
  - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Claude Code
  - –û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
  - –ü—Ä–∏–º–µ—Ä—ã —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞–≥–∏–Ω–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
  - –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- üîÑ **[ROLLING_UPDATE_README.md](ROLLING_UPDATE_README.md)**
  - –°—Ç—Ä–∞—Ç–µ–≥–∏—è even-odd rolling update
  - Ansible –ø–ª–µ–π–±—É–∫–∏
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞

- üìù **[CHANGELOG.md](CHANGELOG.md)**
  - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
  - –°–ø–∏—Å–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –±–∞–≥–æ–≤
  - –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- üêõ **[FIX_SVCS_PID_PARSING.md](FIX_SVCS_PID_PARSING.md)**
  - –î–µ—Ç–∞–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ PID
  - –ü—Ä–æ–±–ª–µ–º–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ
  - –¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏

## –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏ –ø–æ —Ç–µ–º–∞–º

### –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ...

#### ...–Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –∞–≥–µ–Ω—Ç–æ–º
1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ [README.md](README.md) –¥–ª—è –æ–±–∑–æ—Ä–∞
2. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### ...–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HAProxy API
1. –ù–∞—á–Ω–∏—Ç–µ —Å [HAPROXY_API_METHODS_TABLE.md](HAPROXY_API_METHODS_TABLE.md) –¥–ª—è –æ–±–∑–æ—Ä–∞ –º–µ—Ç–æ–¥–æ–≤
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [HAPROXY_CURL_CHEATSHEET.md](HAPROXY_CURL_CHEATSHEET.md) –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∫–æ–º–∞–Ω–¥
3. –ò–∑—É—á–∏—Ç–µ [HAPROXY_API_REFERENCE.md](HAPROXY_API_REFERENCE.md) –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

#### ...–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å HAProxy –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Ä–∞–∑–¥–µ–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ [HAPROXY_API.md](HAPROXY_API.md)
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è production

#### ...–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏
1. –ò–∑—É—á–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤ [HAPROXY_API_REFERENCE.md](HAPROXY_API_REFERENCE.md#—Å—Ü–µ–Ω–∞—Ä–∏–∏-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ansible –ø–ª–µ–π–±—É–∫–∏ –∏–∑ [ROLLING_UPDATE_README.md](ROLLING_UPDATE_README.md)
3. –°–æ–∑–¥–∞–π—Ç–µ bash –∞–ª–∏–∞—Å—ã –∏–∑ [HAPROXY_CURL_CHEATSHEET.md](HAPROXY_CURL_CHEATSHEET.md#–∞–ª–∏–∞—Å—ã-–¥–ª—è-bashrc-zshrc)

#### ...—Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ [CLAUDE.md](CLAUDE.md) –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π discovery –ø–ª–∞–≥–∏–Ω (–ø—Ä–∏–º–µ—Ä—ã –≤ CLAUDE.md)
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (–ø—Ä–∏–º–µ—Ä—ã –≤ CLAUDE.md)

#### ...—Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª Troubleshooting –≤ [HAPROXY_API.md](HAPROXY_API.md#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
2. –ò–∑—É—á–∏—Ç–µ [CHANGELOG.md](CHANGELOG.md) –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ [FIX_SVCS_PID_PARSING.md](FIX_SVCS_PID_PARSING.md) –∫–∞–∫ –ø—Ä–∏–º–µ—Ä —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API –º–µ—Ç–æ–¥–æ–≤

```
/api/v1/haproxy/
‚îú‚îÄ‚îÄ backends                                    # GET - —Å–ø–∏—Å–æ–∫ –±—ç–∫–µ–Ω–¥–æ–≤
‚îú‚îÄ‚îÄ backends/{backend}/servers                  # GET - —Å–µ—Ä–≤–µ—Ä—ã –≤ –±—ç–∫–µ–Ω–¥–µ
‚îú‚îÄ‚îÄ backends/{backend}/servers/{server}/action  # POST - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–º
‚îú‚îÄ‚îÄ {instance}/backends                         # GET - –±—ç–∫–µ–Ω–¥—ã –∏–Ω—Å—Ç–∞–Ω—Å–∞
‚îú‚îÄ‚îÄ {instance}/backends/{backend}/servers       # GET - —Å–µ—Ä–≤–µ—Ä—ã –∏–Ω—Å—Ç–∞–Ω—Å–∞
‚îî‚îÄ‚îÄ {instance}/backends/{backend}/servers/{server}/action  # POST - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–Ω—Å—Ç–∞–Ω—Å–µ
```

## –§–æ—Ä–º–∞—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ï–¥–∏–Ω–∏—á–Ω—ã–π HAProxy –∏–Ω—Å—Ç–∞–Ω—Å
```bash
export HAPROXY_SOCKET_PATH="/var/run/haproxy.sock"
# –∏–ª–∏
export HAPROXY_SOCKET_PATH="ipv4@192.168.1.15:7777"
```

### –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã
```bash
export HAPROXY_INSTANCES="prod=/var/run/haproxy1.sock,staging=/var/run/haproxy2.sock,remote=ipv4@192.168.1.20:7777"
```

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

- –î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ API: —Å–º. [HAPROXY_API_REFERENCE.md](HAPROXY_API_REFERENCE.md)
- –î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ: —Å–º. [CLAUDE.md](CLAUDE.md)
- –î–ª—è –æ—Ç—á–µ—Ç–æ–≤ –æ–± –æ—à–∏–±–∫–∞—Ö: —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏